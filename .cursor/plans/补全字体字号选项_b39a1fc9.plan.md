---
name: 补全字体字号选项
overview: 根据截图与 Word 标准，统一说明单位，并补全演训编辑器的字体与字号列表，确保导入内容回显匹配。
todos:
  - id: update-font-options
    content: 补全字体下拉选项（中文常用+华文系列+文泉驿+微软雅黑Light等）
    status: completed
  - id: update-size-options
    content: 补全字号下拉选项（含5/5.5/6.5/7.5/8/9/10.5等）
    status: completed
  - id: extend-font-fallback
    content: 补全 Word 字体回退映射，确保导入回显一致
    status: completed
  - id: verify-toolbar-match
    content: 确认新增选项与回显逻辑匹配
    status: completed
isProject: false
---

# 补全字体字号并统一单位

## 结论与标准

- Word 默认排版单位是 **pt**，属于印刷排版标准；Web/Tiptap 通常用 **px**。项目中编辑器展示与交互建议统一使用 **px**，在导入/导出时做单位换算（已在 `wordParser.ts`/`htmlToDocx.ts` 看到换算逻辑）。

## 实施步骤

- 更新字体选项：在 `[.../components/toolbar/types.ts](e:/job-project/collabedit-fe/src/views/training/document/components/toolbar/types.ts)` 的 `fontFamilyOptions` 中补全 **中文常用字体 + 华文系列 + 文泉驿系列 + 微软雅黑 Light + 新宋体 + 幼圆** 等截图出现的中文字体，保留已有英文常用字体（如 Arial/Times/Calibri 等）。
- 更新字号选项：在同一文件 `fontSizeOptions` 中补全截图中的全部字号（含 `5/5.5/6.5/7.5/8/9/10.5` 等），并统一为 **px** 值；保持中文字号（初号-小六）对应 px 的映射。
- 扩展字体回退映射：在 `[.../utils/wordParser.ts](e:/job-project/collabedit-fe/src/views/training/document/utils/wordParser.ts)` 的 `chineseFontFallbackMap` 中补全新增中文字体的回退链（例如 华文彩云/华文琥珀/华文新魏/华文行楷/文泉驿微米黑/文泉驿等宽微米黑/微软雅黑 Light/新宋体/幼圆等），确保导入时字体回显与显示一致。
- 校验回显逻辑：复核 `StartToolbar.vue` 的 `normalizeFontFamilyValue/normalizeFontSizeValue` 是否能匹配新增选项（无需改动逻辑，确保新增选项值格式与现有一致）。

## 涉及文件

- `e:/job-project/collabedit-fe/src/views/training/document/components/toolbar/types.ts`
- `e:/job-project/collabedit-fe/src/views/training/document/utils/wordParser.ts`
- （只校验）`e:/job-project/collabedit-fe/src/views/training/document/components/toolbar/StartToolbar.vue`

## 交付与验证

- 导入 `联合指挥作战方案：构建一体化联合作战指挥体系.docx`，选中正文与标题，字体/字号下拉应正确回显。
- 字号下拉应包含截图中的全部字号项（含小字号）。
