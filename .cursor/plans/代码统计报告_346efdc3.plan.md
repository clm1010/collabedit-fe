---
name: 代码统计报告
overview: 统计前端项目的演训方案和模板管理两个模块，以及中间件项目的全部代码。
todos: []
---

# 代码统计报告

---

## 一、前端项目 (collabedit-fe) - 演训方案模块

### 1.1 模块概述

演训方案模块负责演训方案文档的创建、编辑、协同编辑、审核和发布流程。

### 1.2 目录结构

```
src/
├── views/training/
│   ├── document/           # 文档编辑器
│   │   ├── api/           # 文档API
│   │   ├── components/    # 编辑器组件（Tiptap、工具栏）
│   │   ├── config/        # 编辑器配置
│   │   └── utils/         # 工具函数（Word解析等）
│   └── performance/       # 演训方案管理
│       ├── components/    # 业务组件
│       ├── config/        # 配置（分类）
│       └── hooks/         # 业务hooks
├── api/training/index.ts   # 演训API
├── mock/training/performance.ts  # Mock数据
└── types/performance.ts    # 类型定义
```

### 1.3 代码统计

| 位置 | 文件数 | 代码行数 |

|------|--------|----------|

| views/training | 41 | 20,435 |

| api/training/index.ts | 1 | 374 |

| mock/training/performance.ts | 1 | 926 |

| types/performance.ts | 1 | 172 |

| **合计** | **44** | **21,907** |

### 1.4 主要功能文件

- [TiptapCollaborativeEditor.vue](src/views/training/document/TiptapCollaborativeEditor.vue) - 协同编辑器主组件
- [TiptapEditor.vue](src/views/training/document/components/TiptapEditor.vue) - Tiptap编辑器
- [EditorToolbar.vue](src/views/training/document/components/toolbar/EditorToolbar.vue) - 工具栏
- [performance/index.vue](src/views/training/performance/index.vue) - 演训方案列表页
- [PerformanceForm.vue](src/views/training/performance/components/PerformanceForm.vue) - 方案表单

---

## 二、前端项目 (collabedit-fe) - 模板管理模块

### 2.1 模块概述

模板管理模块负责文档模板的创建、编辑、自定义要素配置、审核和发布。

### 2.2 目录结构

```
src/
├── views/template/
│   ├── editor/            # Markdown编辑器
│   │   ├── api/          # 编辑器API
│   │   ├── components/   # 编辑器组件
│   │   ├── config/       # 配置
│   │   ├── extensions/   # Tiptap扩展
│   │   └── utils/        # 工具函数
│   └── management/       # 模板管理
│       └── components/   # 业务组件
├── api/template/index.ts  # 模板API
├── mock/template/management.ts  # Mock数据
└── types/management.ts    # 类型定义
```

### 2.3 代码统计

| 位置 | 文件数 | 代码行数 |

|------|--------|----------|

| views/template | 17 | 8,402 |

| api/template/index.ts | 1 | 390 |

| mock/template/management.ts | 1 | 604 |

| types/management.ts | 1 | 167 |

| **合计** | **20** | **9,563** |

### 2.4 主要功能文件

- [MarkdownCollaborativeEditor.vue](src/views/template/editor/MarkdownCollaborativeEditor.vue) - Markdown协同编辑器
- [MarkdownEditor.vue](src/views/template/editor/components/MarkdownEditor.vue) - Markdown编辑器
- [management/index.vue](src/views/template/management/index.vue) - 模板列表页
- [ElementsEditor.vue](src/views/template/management/components/ElementsEditor.vue) - 自定义要素编辑器
- [AIBlockComponent.vue](src/views/template/editor/components/AIBlockComponent.vue) - AI块组件

---

## 三、中间件项目 (collaborative-middleware)

### 3.1 模块概述

协同编辑中间件，基于 NestJS + WebSocket + Y.js 实现实时协同编辑功能。

### 3.2 目录结构

```
src/
├── main.ts                              # 启动入口
├── app.module.ts                        # 主模块
├── collaboration/                       # 文档协同编辑
│   ├── collaboration.gateway.ts         # WebSocket网关
│   ├── collaboration.module.ts          # 模块定义
│   └── ws.adapter.ts                    # WebSocket适配器
└── markdown-collaboration/              # Markdown协同编辑
    ├── markdown-collaboration.gateway.ts # WebSocket网关
    └── markdown-collaboration.module.ts  # 模块定义
```

### 3.3 代码统计

| 文件 | 代码行数 | 功能描述 |

|------|----------|----------|

| main.ts | 70 | 应用启动入口 |

| app.module.ts | 32 | 主模块配置 |

| collaboration/collaboration.gateway.ts | 455 | 文档协同WebSocket网关 |

| collaboration/collaboration.module.ts | 9 | 协同模块 |

| collaboration/ws.adapter.ts | 105 | WebSocket适配器 |

| markdown-collaboration/markdown-collaboration.gateway.ts | 440 | Markdown协同网关 |

| markdown-collaboration/markdown-collaboration.module.ts | 10 | Markdown协同模块 |

| **合计** | **7个文件** | **1,121行** |

### 3.4 核心功能

- 实时文档同步（Y.js CRDT）
- 用户感知（Awareness）管理
- 心跳检测与连接清理
- 多设备连接支持
- 文档内存自动清理

---

## 四、总体统计汇总

| 项目/模块 | 文件数 | 代码行数 |

|-----------|--------|----------|

| 前端 - 演训方案模块 | 44 | 21,907 |

| 前端 - 模板管理模块 | 20 | 9,563 |

| 中间件 - 全部 | 7 | 1,121 |

| **总计** | **71** | **32,591** |

### 前端两模块合计

- 文件数：64 个
- 代码行数：31,470 行

### 技术栈

- **前端**: Vue 3 + TypeScript + Tiptap + Y.js
- **中间件**: NestJS + WebSocket + Y.js + TypeScript